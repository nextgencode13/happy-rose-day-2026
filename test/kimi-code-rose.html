<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Rose Day, My Love üåπ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Lato:wght@300;400;700&display=swap"
        rel="stylesheet">
    <style>
        /* Custom Font Setup */
        body {
            font-family: 'Lato', sans-serif;
            overflow-x: hidden;
            background-color: #1a0505;
            color: #fff;
        }

        h1,
        h2,
        h3,
        .romantic-font {
            font-family: 'Dancing Script', cursive;
        }

        /* Scrollbar Hide */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #2d0a0a;
        }

        ::-webkit-scrollbar-thumb {
            background: #e11d48;
            border-radius: 4px;
        }

        /* Animations */
        @keyframes float {
            0% {
                transform: translateY(0px) rotate(0deg);
            }

            50% {
                transform: translateY(-20px) rotate(2deg);
            }

            100% {
                transform: translateY(0px) rotate(0deg);
            }
        }

        .animate-float {
            animation: float 6s ease-in-out infinite;
        }

        @keyframes glow {

            0%,
            100% {
                box-shadow: 0 0 20px rgba(225, 29, 72, 0.5);
            }

            50% {
                box-shadow: 0 0 40px rgba(225, 29, 72, 0.8), 0 0 60px rgba(225, 29, 72, 0.4);
            }
        }

        .glow-effect {
            animation: glow 3s infinite;
        }

        @keyframes sway {
            0% {
                transform: rotate(-3deg);
            }

            50% {
                transform: rotate(3deg);
            }

            100% {
                transform: rotate(-3deg);
            }
        }

        .polaroid-sway {
            animation: sway 4s ease-in-out infinite;
            transform-origin: top center;
        }

        /* 3D Rose CSS Construction */
        .rose-scene {
            perspective: 1000px;
            width: 200px;
            height: 200px;
            margin: 0 auto;
        }

        .rose-wrapper {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            animation: spinRose 20s linear infinite;
        }

        @keyframes spinRose {
            from {
                transform: rotateY(0deg);
            }

            to {
                transform: rotateY(360deg);
            }
        }

        .petal {
            position: absolute;
            bottom: 50%;
            left: 50%;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle at 30% 30%, #ff4d6d, #a61e34);
            border-radius: 50% 50% 0 50%;
            transform-origin: bottom left;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
            opacity: 0.9;
        }

        /* Simplified CSS Rose for performance and pure CSS aesthetic */
        .css-rose {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 0 auto;
        }

        .css-rose div {
            position: absolute;
            border-radius: 50%;
        }

        .r1 {
            width: 100px;
            height: 100px;
            background: #c9184a;
            top: 0;
            left: 0;
            z-index: 5;
            transform: rotate(45deg);
        }

        .r2 {
            width: 90px;
            height: 90px;
            background: #ff4d6d;
            top: 5px;
            left: 5px;
            z-index: 6;
            transform: rotate(20deg);
        }

        .r3 {
            width: 80px;
            height: 80px;
            background: #ff758f;
            top: 10px;
            left: 10px;
            z-index: 7;
            transform: rotate(60deg);
        }

        .r4 {
            width: 70px;
            height: 70px;
            background: #c9184a;
            top: 15px;
            left: 15px;
            z-index: 8;
            transform: rotate(0deg);
        }

        .r5 {
            width: 50px;
            height: 50px;
            background: #800f2f;
            top: 25px;
            left: 25px;
            z-index: 9;
            border-radius: 50%;
        }

        /* Glassmorphism */
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Typewriter Cursor */
        .cursor::after {
            content: '|';
            animation: blink 1s infinite;
        }

        @keyframes blink {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0;
            }
        }

        /* Gift Box */
        .gift-box-lid {
            transition: transform 0.5s ease;
            transform-origin: bottom left;
        }

        .gift-container.open .gift-box-lid {
            transform: rotate(-110deg);
        }

        .gift-surprise {
            transition: all 0.5s ease 0.3s;
            transform: scale(0) translateY(20px);
            opacity: 0;
        }

        .gift-container.open .gift-surprise {
            transform: scale(1) translateY(-60px);
            opacity: 1;
        }

        /* Modal */
        .modal-overlay {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .modal-content {
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal-content {
            transform: scale(1);
        }
    </style>
    <base target="_blank">
</head>

<body class="antialiased selection:bg-rose-500 selection:text-white">

    <!-- Background Canvas for Petals -->
    <canvas id="petalCanvas" class="fixed top-0 left-0 w-full h-full pointer-events-none z-50"></canvas>

    <!-- Background Music (Hidden) -->
    <audio id="bgMusic" loop>
        <source
            src="https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3?filename=soft-piano-100-bpm-121529.mp3"
            type="audio/mpeg">
    </audio>

    <!-- Navigation / Music Toggle -->
    <div class="fixed top-6 right-6 z-40">
        <button id="musicToggle" class="glass p-3 rounded-full hover:bg-white/10 transition-all group">
            <span id="musicIcon">üéµ</span>
            <span
                class="absolute right-full mr-3 top-1/2 -translate-y-1/2 bg-black/80 px-2 py-1 rounded text-xs whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity">Play
                Music</span>
        </button>
    </div>

    <!-- SECTION 1: HERO -->
    <section id="hero"
        class="relative min-h-screen flex flex-col items-center justify-center overflow-hidden bg-gradient-to-b from-rose-950 via-rose-900 to-black">

        <!-- Ambient Glow -->
        <div
            class="absolute top-1/4 left-1/2 -translate-x-1/2 w-[500px] h-[500px] bg-rose-600/20 rounded-full blur-[100px] animate-pulse">
        </div>

        <div class="relative z-10 text-center px-4 max-w-4xl mx-auto">
            <div class="glass p-8 md:p-12 rounded-3xl shadow-2xl border border-rose-500/30 glow-effect">

                <h1 class="text-5xl md:text-7xl text-rose-400 mb-4 drop-shadow-lg opacity-0 translate-y-10 transition-all duration-1000"
                    id="heroTitle">
                    Happy Rose Day, My Love üåπ
                </h1>

                <p class="text-xl md:text-2xl text-rose-200/80 mb-8 font-light opacity-0 transition-all duration-1000 delay-500"
                    id="heroSub">
                    A rose for you, as beautiful as your smile
                </p>

                <!-- 3D Rose Representation -->
                <div class="h-48 flex items-center justify-center mb-8 opacity-0 scale-50 transition-all duration-1000 delay-700"
                    id="heroRose">
                    <div class="rose-scene">
                        <div class="rose-wrapper">
                            <div class="css-rose">
                                <div class="r1"></div>
                                <div class="r2"></div>
                                <div class="r3"></div>
                                <div class="r4"></div>
                                <div class="r5"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <button onclick="scrollToSection('letter')"
                    class="group relative px-8 py-4 bg-gradient-to-r from-rose-600 to-pink-600 rounded-full text-white font-bold text-lg shadow-lg hover:shadow-rose-500/50 transition-all hover:-translate-y-1 overflow-hidden">
                    <span class="relative z-10">Send You a Rose</span>
                    <div
                        class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300">
                    </div>
                </button>
            </div>
        </div>
    </section>

    <!-- SECTION 2: LOVE LETTER -->
    <section id="letter"
        class="min-h-screen flex items-center justify-center bg-gradient-to-b from-black via-rose-950 to-rose-900 py-20 px-4">
        <div class="max-w-2xl w-full relative group perspective-1000" onclick="toggleLetter()">
            <!-- Floating Hearts Background -->
            <div class="absolute -inset-10 pointer-events-none" id="letterHearts"></div>

            <div id="letterCard"
                class="relative bg-[#fdf6e3] text-rose-900 p-8 md:p-12 rounded-lg shadow-2xl transform transition-all duration-500 cursor-pointer hover:-translate-y-2 border-8 border-double border-rose-200">
                <div
                    class="absolute -top-6 left-1/2 -translate-x-1/2 w-12 h-12 bg-rose-600 rounded-full flex items-center justify-center text-2xl shadow-lg z-20">
                    üíå
                </div>

                <h2 class="text-4xl text-center mb-8 text-rose-800 border-b-2 border-rose-200 pb-4">My Dearest</h2>

                <div class="min-h-[200px] font-serif text-lg leading-relaxed text-rose-950/90">
                    <p id="typewriterText" class="cursor"></p>
                </div>

                <div class="mt-8 text-right font-bold text-rose-800 text-xl romantic-font">
                    - Forever Yours
                </div>

                <div class="mt-4 text-center text-xs text-rose-400 uppercase tracking-widest">
                    Click to read a new quote
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION 3: ROSE GALLERY -->
    <section id="gallery" class="min-h-screen py-20 px-4 bg-gradient-to-b from-rose-900 to-black">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-5xl text-center mb-16 text-rose-400 drop-shadow-lg">The Language of Roses</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                <!-- Card 1 -->
                <div class="group relative h-96 cursor-pointer" onclick="openModal('red')">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent z-10 rounded-2xl"></div>
                    <img src="https://images.unsplash.com/photo-1518709766631-a6a7f45921c3?auto=format&fit=crop&w=600&q=80"
                        alt="Red Rose"
                        class="w-full h-full object-cover rounded-2xl shadow-lg transition-transform duration-500 group-hover:scale-110">
                    <div
                        class="absolute bottom-0 left-0 w-full p-6 z-20 transform translate-y-4 group-hover:translate-y-0 transition-transform">
                        <h3 class="text-3xl text-white mb-2">Red Rose</h3>
                        <p class="text-rose-200 opacity-0 group-hover:opacity-100 transition-opacity duration-300">Deep
                            Love & Passion</p>
                    </div>
                </div>

                <!-- Card 2 -->
                <div class="group relative h-96 cursor-pointer" onclick="openModal('pink')">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent z-10 rounded-2xl"></div>
                    <img src="https://images.unsplash.com/photo-1496857239036-1fb13768f18f?auto=format&fit=crop&w=600&q=80"
                        alt="Pink Rose"
                        class="w-full h-full object-cover rounded-2xl shadow-lg transition-transform duration-500 group-hover:scale-110">
                    <div
                        class="absolute bottom-0 left-0 w-full p-6 z-20 transform translate-y-4 group-hover:translate-y-0 transition-transform">
                        <h3 class="text-3xl text-white mb-2">Pink Rose</h3>
                        <p class="text-rose-200 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                            Admiration & Sweetness</p>
                    </div>
                </div>

                <!-- Card 3 -->
                <div class="group relative h-96 cursor-pointer" onclick="openModal('white')">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent z-10 rounded-2xl"></div>
                    <img src="https://images.unsplash.com/photo-1559563362-c667ba5f5480?auto=format&fit=crop&w=600&q=80"
                        alt="White Rose"
                        class="w-full h-full object-cover rounded-2xl shadow-lg transition-transform duration-500 group-hover:scale-110">
                    <div
                        class="absolute bottom-0 left-0 w-full p-6 z-20 transform translate-y-4 group-hover:translate-y-0 transition-transform">
                        <h3 class="text-3xl text-white mb-2">White Rose</h3>
                        <p class="text-rose-200 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                            Purity & Innocence</p>
                    </div>
                </div>

                <!-- Card 4 -->
                <div class="group relative h-96 cursor-pointer" onclick="openModal('yellow')">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent z-10 rounded-2xl"></div>
                    <img src="https://images.unsplash.com/photo-1559563458-527698bf5295?auto=format&fit=crop&w=600&q=80"
                        alt="Yellow Rose"
                        class="w-full h-full object-cover rounded-2xl shadow-lg transition-transform duration-500 group-hover:scale-110">
                    <div
                        class="absolute bottom-0 left-0 w-full p-6 z-20 transform translate-y-4 group-hover:translate-y-0 transition-transform">
                        <h3 class="text-3xl text-white mb-2">Yellow Rose</h3>
                        <p class="text-rose-200 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                            Friendship & Joy</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION 4: MEMORIES (POLAROIDS) -->
    <section id="memories" class="min-h-screen py-20 px-4 bg-black relative overflow-hidden">
        <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/stardust.png')] opacity-20">
        </div>

        <h2 class="text-5xl text-center mb-20 text-rose-400 relative z-10">Our Moments</h2>

        <div class="flex flex-wrap justify-center gap-12 max-w-6xl mx-auto relative z-10">
            <!-- Polaroid 1 -->
            <div class="polaroid-sway bg-white p-3 pb-12 shadow-2xl transform rotate-3 hover:rotate-0 hover:scale-110 transition-all duration-300 cursor-pointer w-64"
                onclick="showMemory(1)">
                <div class="w-full h-64 bg-gray-200 overflow-hidden">
                    <img src="https://images.unsplash.com/photo-1516589178581-6cd7833ae3b2?auto=format&fit=crop&w=400&q=80"
                        class="w-full h-full object-cover filter sepia-[.3]">
                </div>
                <div class="text-center mt-4 text-gray-800 font-handwriting text-xl romantic-font">First Date</div>
            </div>

            <!-- Polaroid 2 -->
            <div class="polaroid-sway bg-white p-3 pb-12 shadow-2xl transform -rotate-2 hover:rotate-0 hover:scale-110 transition-all duration-300 cursor-pointer w-64"
                style="animation-delay: 1s;" onclick="showMemory(2)">
                <div class="w-full h-64 bg-gray-200 overflow-hidden">
                    <img src="https://images.unsplash.com/photo-1529333166437-7750a6dd5a70?auto=format&fit=crop&w=400&q=80"
                        class="w-full h-full object-cover filter sepia-[.3]">
                </div>
                <div class="text-center mt-4 text-gray-800 font-handwriting text-xl romantic-font">Sunset Walks</div>
            </div>

            <!-- Polaroid 3 -->
            <div class="polaroid-sway bg-white p-3 pb-12 shadow-2xl transform rotate-6 hover:rotate-0 hover:scale-110 transition-all duration-300 cursor-pointer w-64"
                style="animation-delay: 2s;" onclick="showMemory(3)">
                <div class="w-full h-64 bg-gray-200 overflow-hidden">
                    <img src="https://images.unsplash.com/photo-1522673607200-1645062cd958?auto=format&fit=crop&w=400&q=80"
                        class="w-full h-full object-cover filter sepia-[.3]">
                </div>
                <div class="text-center mt-4 text-gray-800 font-handwriting text-xl romantic-font">Forever Us</div>
            </div>
        </div>
    </section>

    <!-- SECTION 5: SURPRISE GIFT -->
    <section id="surprise"
        class="min-h-screen flex flex-col items-center justify-center bg-gradient-to-b from-black to-rose-950 py-20">
        <h2 class="text-4xl mb-12 text-rose-200">A Surprise For You</h2>

        <div class="gift-container relative w-64 h-64 cursor-pointer" onclick="openGift(this)">
            <!-- Box -->
            <div
                class="absolute bottom-0 w-full h-48 bg-rose-700 rounded-lg shadow-2xl z-10 flex items-center justify-center border-b-8 border-rose-900">
                <div class="w-full h-8 bg-rose-400 absolute"></div>
                <div class="h-full w-8 bg-rose-400 absolute"></div>
            </div>

            <!-- Lid -->
            <div
                class="gift-box-lid absolute -top-8 w-[110%] -left-[5%] h-16 bg-rose-600 rounded-lg shadow-lg z-20 flex items-center justify-center border-b-4 border-rose-800">
                <div class="w-full h-8 bg-rose-400 absolute"></div>
                <div class="h-full w-8 bg-rose-400 absolute"></div>
                <div class="w-20 h-20 bg-rose-300 rounded-full absolute -top-10 shadow-md"></div>
            </div>

            <!-- Surprise Content -->
            <div class="gift-surprise absolute bottom-20 left-1/2 -translate-x-1/2 z-0 flex flex-col items-center">
                <div class="text-6xl animate-bounce">üåπ</div>
                <div class="text-6xl animate-bounce" style="animation-delay: 0.1s">üåπ</div>
                <div class="text-6xl animate-bounce" style="animation-delay: 0.2s">üåπ</div>
                <div class="mt-4 text-2xl font-bold text-rose-300 whitespace-nowrap romantic-font">You are my forever
                    rose</div>
            </div>
        </div>

        <p class="mt-12 text-rose-400/60 animate-pulse">Click the box</p>
    </section>

    <!-- SECTION 6: PERSONAL MESSAGE -->
    <section id="message" class="min-h-screen flex flex-col items-center justify-center bg-rose-950 py-20 px-4">
        <div class="max-w-2xl w-full glass p-8 rounded-3xl border border-rose-500/30">
            <h2 class="text-4xl text-center mb-8 text-rose-300">Create a Rose Wish</h2>

            <div class="space-y-6">
                <textarea id="userMessage" rows="4"
                    class="w-full bg-black/30 border border-rose-500/30 rounded-xl p-4 text-rose-100 focus:outline-none focus:border-rose-500 transition-colors resize-none"
                    placeholder="Write your feelings here..."></textarea>

                <button onclick="createRoseWish()"
                    class="w-full py-3 bg-rose-600 hover:bg-rose-500 text-white rounded-xl font-bold transition-all transform hover:scale-[1.02]">
                    Create Rose Wish
                </button>
            </div>

            <!-- Output Frame -->
            <div id="roseFrame" class="hidden mt-8 relative p-8 text-center">
                <div class="absolute inset-0 border-2 border-rose-400 rounded-[3rem] transform rotate-3"></div>
                <div class="absolute inset-0 border-2 border-rose-400 rounded-[3rem] transform -rotate-3"></div>
                <div class="relative bg-rose-900/80 p-6 rounded-[2.5rem]">
                    <div class="text-4xl mb-4">üåπ</div>
                    <p id="displayMessage" class="text-xl text-rose-100 italic font-serif"></p>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION 7: FINALE -->
    <section id="finale"
        class="min-h-screen flex flex-col items-center justify-center bg-gradient-to-b from-rose-950 to-black relative overflow-hidden">
        <!-- Stars -->
        <div class="absolute inset-0" id="starfield"></div>

        <!-- Moon -->
        <div
            class="absolute top-20 right-20 w-32 h-32 bg-rose-100 rounded-full shadow-[0_0_60px_rgba(255,255,255,0.5)] opacity-80">
        </div>

        <div class="z-10 text-center px-4">
            <h2 class="text-5xl md:text-7xl text-transparent bg-clip-text bg-gradient-to-r from-rose-200 to-rose-500 mb-8 opacity-0 translate-y-10 transition-all duration-1000"
                id="finaleText">
                Every rose reminds me of you
            </h2>

            <button
                class="mt-8 px-10 py-4 bg-transparent border-2 border-rose-500 text-rose-400 text-xl rounded-full hover:bg-rose-500 hover:text-white transition-all duration-300 glow-effect">
                Happy Rose Day ‚ù§Ô∏è
            </button>
        </div>

        <!-- Floating Lanterns -->
        <div class="absolute bottom-0 left-0 w-full h-full pointer-events-none overflow-hidden" id="lanterns"></div>
    </section>

    <!-- MODAL OVERLAY -->
    <div id="modal"
        class="modal-overlay fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4"
        onclick="closeModal()">
        <div class="modal-content bg-rose-900 border border-rose-500/50 p-1 rounded-2xl max-w-lg w-full relative"
            onclick="event.stopPropagation()">
            <button onclick="closeModal()"
                class="absolute -top-4 -right-4 w-10 h-10 bg-black rounded-full text-white flex items-center justify-center border border-rose-500 hover:bg-rose-600 transition-colors z-50">‚úï</button>
            <img id="modalImg" src="" class="w-full h-64 object-cover rounded-xl">
            <div class="p-6 text-center">
                <h3 id="modalTitle" class="text-3xl text-rose-300 mb-2"></h3>
                <p id="modalDesc" class="text-rose-100/80"></p>
            </div>
        </div>
    </div>

    <script>
        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            initHeroAnimations();
            initCanvas();
            initStarfield();
            initLanterns();
            initObservers();
        });

        // --- Hero Animations ---
        function initHeroAnimations() {
            setTimeout(() => {
                document.getElementById('heroTitle').classList.remove('opacity-0', 'translate-y-10');
            }, 100);
            setTimeout(() => {
                document.getElementById('heroSub').classList.remove('opacity-0');
            }, 600);
            setTimeout(() => {
                document.getElementById('heroRose').classList.remove('opacity-0', 'scale-50');
            }, 800);
        }

        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
            burstPetals(window.innerWidth / 2, window.innerHeight / 2);
        }

        // --- Music Player ---
        const musicBtn = document.getElementById('musicToggle');
        const music = document.getElementById('bgMusic');
        let isPlaying = false;

        musicBtn.addEventListener('click', () => {
            if (isPlaying) {
                music.pause();
                musicBtn.innerHTML = '<span id="musicIcon">üéµ</span>';
            } else {
                music.play();
                musicBtn.innerHTML = '<span id="musicIcon">‚è∏</span>';
            }
            isPlaying = !isPlaying;
        });

        // --- Typewriter Effect ---
        const quotes = [
            "Roses are red, violets are blue, my heart is full of love for you.",
            "In a garden of roses, you are the most beautiful bloom.",
            "Every moment with you is like a petal in the eternal rose of my life.",
            "You are the rose that makes my life beautiful.",
            "My love for you is like a rose, eternal and beautiful."
        ];
        let quoteIndex = 0;
        let charIndex = 0;
        let isTyping = false;
        const typeElement = document.getElementById('typewriterText');

        function typeWriter() {
            if (charIndex < quotes[quoteIndex].length) {
                typeElement.innerHTML += quotes[quoteIndex].charAt(charIndex);
                charIndex++;
                setTimeout(typeWriter, 50);
            } else {
                isTyping = false;
            }
        }

        function toggleLetter() {
            if (isTyping) return;
            typeElement.innerHTML = '';
            charIndex = 0;
            quoteIndex = (quoteIndex + 1) % quotes.length;
            isTyping = true;
            typeWriter();
            createFloatingHearts();
        }

        // Start first quote when visible
        setTimeout(typeWriter, 2000);

        // --- Canvas Petals System ---
        const canvas = document.getElementById('petalCanvas');
        const ctx = canvas.getContext('2d');
        let petals = [];
        let width, height;

        function initCanvas() {
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            animatePetals();
        }

        function resizeCanvas() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        }

        class Petal {
            constructor(x, y, isBurst = false) {
                this.x = x || Math.random() * width;
                this.y = y || -20;
                this.size = Math.random() * 10 + 5;
                this.speedY = Math.random() * 1 + 0.5;
                this.speedX = Math.random() * 2 - 1;
                this.rotation = Math.random() * 360;
                this.rotationSpeed = Math.random() * 2 - 1;
                this.color = `rgba(${200 + Math.random() * 55}, ${50 + Math.random() * 50}, ${50 + Math.random() * 50}, ${Math.random() * 0.5 + 0.3})`;
                this.isBurst = isBurst;
                if (isBurst) {
                    this.speedY = (Math.random() - 0.5) * 10;
                    this.speedX = (Math.random() - 0.5) * 10;
                    this.life = 100;
                }
            }

            update() {
                this.y += this.speedY;
                this.x += this.speedX;
                this.rotation += this.rotationSpeed;

                if (this.isBurst) {
                    this.life--;
                    this.speedY *= 0.95; // friction
                    this.speedX *= 0.95;
                } else {
                    // Normal falling logic
                    if (this.y > height) {
                        this.y = -20;
                        this.x = Math.random() * width;
                    }
                }
            }

            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.rotation * Math.PI / 180);
                ctx.fillStyle = this.color;
                // Draw petal shape
                ctx.beginPath();
                ctx.ellipse(0, 0, this.size, this.size / 2, 0, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            }
        }

        // Initial population
        for (let i = 0; i < 30; i++) {
            petals.push(new Petal());
        }

        function animatePetals() {
            ctx.clearRect(0, 0, width, height);

            for (let i = 0; i < petals.length; i++) {
                petals[i].update();
                petals[i].draw();

                if (petals[i].isBurst && petals[i].life <= 0) {
                    petals.splice(i, 1);
                    i--;
                }
            }
            requestAnimationFrame(animatePetals);
        }

        function burstPetals(x, y) {
            for (let i = 0; i < 30; i++) {
                petals.push(new Petal(x, y, true));
            }
        }

        // --- Gallery Modal ---
        const roseData = {
            'red': { title: 'Red Rose', desc: 'The ultimate symbol of romantic love and enduring passion. It speaks of deep emotions and desire.', img: 'https://images.unsplash.com/photo-1518709766631-a6a7f45921c3?auto=format&fit=crop&w=800&q=80' },
            'pink': { title: 'Pink Rose', desc: 'A symbol of grace, elegance, and sweetness. It conveys admiration, joy, and gratitude.', img: 'https://images.unsplash.com/photo-1496857239036-1fb13768f18f?auto=format&fit=crop&w=800&q=80' },
            'white': { title: 'White Rose', desc: 'Represents purity, innocence, and new beginnings. Often associated with young love and loyalty.', img: 'https://images.unsplash.com/photo-1559563362-c667ba5f5480?auto=format&fit=crop&w=800&q=80' },
            'yellow': { title: 'Yellow Rose', desc: 'A symbol of friendship, joy, and caring. It radiates warmth, delight, and affection.', img: 'https://images.unsplash.com/photo-1559563458-527698bf5295?auto=format&fit=crop&w=800&q=80' }
        };

        function openModal(color) {
            const data = roseData[color];
            document.getElementById('modalImg').src = data.img;
            document.getElementById('modalTitle').innerText = data.title;
            document.getElementById('modalDesc').innerText = data.desc;
            document.getElementById('modal').classList.add('active');
            burstPetals(window.innerWidth / 2, window.innerHeight / 2);
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('active');
        }

        // --- Gift Box ---
        function openGift(el) {
            if (!el.classList.contains('open')) {
                el.classList.add('open');
                burstPetals(window.innerWidth / 2, window.innerHeight / 2);
            }
        }

        // --- Rose Wish ---
        function createRoseWish() {
            const msg = document.getElementById('userMessage').value;
            if (msg.trim() === "") return;

            document.getElementById('displayMessage').innerText = msg;
            document.getElementById('roseFrame').classList.remove('hidden');
            burstPetals(window.innerWidth / 2, window.innerHeight / 2);
        }

        // --- Visual Effects (Hearts & Stars) ---
        function createFloatingHearts() {
            const container = document.getElementById('letterHearts');
            for (let i = 0; i < 5; i++) {
                const heart = document.createElement('div');
                heart.innerHTML = '‚ù§Ô∏è';
                heart.style.position = 'absolute';
                heart.style.left = Math.random() * 100 + '%';
                heart.style.top = Math.random() * 100 + '%';
                heart.style.opacity = 0;
                heart.style.transition = 'all 2s ease-out';
                heart.style.fontSize = (Math.random() * 20 + 10) + 'px';
                container.appendChild(heart);

                setTimeout(() => {
                    heart.style.opacity = 1;
                    heart.style.transform = `translateY(-50px)`;
                }, 10);
                setTimeout(() => heart.remove(), 2000);
            }
        }

        function initStarfield() {
            const container = document.getElementById('starfield');
            for (let i = 0; i < 50; i++) {
                const star = document.createElement('div');
                star.className = 'absolute bg-white rounded-full';
                star.style.width = Math.random() * 3 + 'px';
                star.style.height = star.style.width;
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.opacity = Math.random();
                star.style.animation = `pulse ${Math.random() * 3 + 2}s infinite`;
                container.appendChild(star);
            }
        }

        function initLanterns() {
            const container = document.getElementById('lanterns');
            setInterval(() => {
                const lantern = document.createElement('div');
                lantern.innerHTML = 'üèÆ';
                lantern.style.position = 'absolute';
                lantern.style.bottom = '-50px';
                lantern.style.left = Math.random() * 100 + '%';
                lantern.style.fontSize = '30px';
                lantern.style.opacity = 0.8;
                lantern.style.transition = `all ${Math.random() * 5 + 10}s linear`;
                container.appendChild(lantern);

                setTimeout(() => {
                    lantern.style.transform = `translateY(-${window.innerHeight + 100}px)`;
                }, 100);

                setTimeout(() => lantern.remove(), 15000);
            }, 2000);
        }

        // --- Intersection Observer for Scroll Animations ---
        function initObservers() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        if (entry.target.id === 'finale') {
                            document.getElementById('finaleText').classList.remove('opacity-0', 'translate-y-10');
                        }
                    }
                });
            }, { threshold: 0.3 });

            observer.observe(document.getElementById('finale'));
        }

        // --- Mouse Trail Hearts ---
        document.addEventListener('mousemove', (e) => {
            if (Math.random() > 0.9) { // Only create occasionally
                const heart = document.createElement('div');
                heart.innerHTML = 'üíñ';
                heart.style.position = 'fixed';
                heart.style.left = e.clientX + 'px';
                heart.style.top = e.clientY + 'px';
                heart.style.pointerEvents = 'none';
                heart.style.fontSize = '12px';
                heart.style.zIndex = '100';
                heart.style.transition = 'all 1s ease-out';
                document.body.appendChild(heart);

                setTimeout(() => {
                    heart.style.transform = 'translateY(20px) scale(0)';
                    heart.style.opacity = 0;
                }, 10);
                setTimeout(() => heart.remove(), 1000);
            }
        });

    </script>
</body>

</html>